u <- c(2,4,6,8,1)
typeof(u)
mode(u)
class(u)
v <- c(1,3,5,7,9)
u + v
w <- c(,6,5,4,3,2,1)
w <- c(6,5,4,3,2,1)
u + w
w <- c(6,5,4,3,2,1,1,1,1,9)
u + w
u * v
x <- c("hello"
,"goodbye")
x
li <- list(u,v,w,x)
li
li[2]
li[[2]]
typeof(li[[2]])
typeof(li[2])
typeof(li[2:3])
air1 <- scan('usair.cleaner.csv', sep=',', skip=1, what=list(0L,"","","",0,"","",0,0,0))
head(air1)
options(max.print=100)
head(air1)
typeof(air1)
typeof(air1[[1]])
typeof(air1[1])
typeof(air1[3])
typeof(air1[5])
typeof(air1[6])
typeof(air1[[6]])
typeof(air1[[5]])
for (i in 1:10) { print(typeof(air1[i])) }
for (i in 1:10) { print(typeof(air1[[i]])) }
for (i in 1:10) { print(length(air1[[i]])) }
air2 <- as.data.frame(air1)
str(air1)
str(air2)
system("who")
s <- system("who",intern=T)
s
s <- system(" head -1 usair.cleaner.csv | sed 's/[a-z]*/\"&\"/g'", intern=T)
s
s <- system(" head -1 usair.cleaner.csv | sed 's/[a-z]*/\'&\'/g'", intern=T)
s <- system(' head -1 usair.cleaner.csv | sed "s/[a-z]*/\'&\'/g"', intern=T)
s
names(air2) <- c('id','name','city','code','offset','dst','timezone','alt','lat','lon')
str(air2)
air2[2]
air2[3]
air2[1]
air2[9]
air2$city
air2["city"]
air2[3,]
air2[1,]
air2[1:10,]
air2[air2$alt > 5280,]
air2[air2$alt > 5280,]
options(width=142)
air2[air2$alt > 5280,]
option(width=system("tput cols",intern=T))
options(width=system("tput cols",intern=T))
air2[air2$alt > 5280,]
air2[air2$alt > 5280,3]
air2[air2$alt > 5280,"city"]
plot(air2$lon,air2$lat,pch=16)
air2[air2$lon > 100,]
air2[air2$city == "San Diego",]
air2$offset[1205] <- -8
air2[air2$city == "San Diego",]
air2$timezone[1205] <- "America/Los_Angeles"
air2$lon[1205] <- -117.7590
plot(air2$lon,air2$lat,pch=16)
air2[air2$lon > 100,]
air2[air2$city == "Phoenix",]
air2[substr(air2$city,1,4) == "Phoe",]
air2$lon[1110] <- -air2$lon[1110]
air2$city[1110] <- "Phoenix"
air2$offset[1110] <- -7
air2$timezone[1110] <- "America/Phoenix"
air2[air2$city == "Phoenix",]
air2[air2$lon > 100,]
air2$lon[431] <- air2$lon[431] - 360
plot(air2$lon,air2$lat,pch=16)
pdf("airport.pdf")
plot(air2$lon,air2$lat,pch=16)
?file.append
x <- c(1,2,3)
x ** 2
nrand(3,1,10)
randr(3,1,10)
randn(3,1,10)
rnorm(3,1,10)
?rnorm
t <- rnorm(100,2,10
)
t
boxplot(t)
boxplot(t/0.7)
li <- scan('data',what=list('','','','','','','',''))
names(li) <- c('user','ip','wday','mon','mday','in','out','rawtime')
str(li)
df <- as.data.frame(li)
head(df)
df$rawtime
f <- function(x) { return(x+1) }
f(4)
?grep
?substr
substr("alphabet",1,3)
?split
split("2+34:56",sep='+')
?SPLIT
?split
fg
?strsplit
strsplit("2+34:56",sep='+')
strsplit("2+34:56",'+')
?strsplit
strsplit("2+34:56",'+')
?strsplit
strsplit("2+34:56",'+',fixed=T)
q
strsplit("2+34:56",'+',fixed=T)
source('tominutes.r')
source('tominute.r')
source('tominutes.r')
source('tominute.r')
tominute('1+10:07')
toMinutes('1+10:07')
source('toMinutes.r')
toMinutes('1+10:07')
body('toMinutes')
s <- '1+10:45'
t <- strsplit(s, "+", fixed = TRUE)
t
t[1]
t[[1]][1]
t <- strsplit(s, "+", fixed = TRUE)
t
source('toMinutes.r')
toMinutes(s)
s
toMinutes("02:30")
df$rawtime
sapply(df$rawtime, toMinutes)
str(df)
option(stringsAsFactors=FALSE)
options(stringsAsFactors=FALSE)
li <- scan('data',what=list('','','','','','','',''))
df <- as.data.frame(li)
str(df)
names(li) <- c('user','ip','wday','mon','mday','in','out','rawtime')
df <- as.data.frame(li)
str(df)
str(df)
head(df)
sapply(df$rawtime, toMinutes)
df$et <- sapply(df$rawtime, toMinutes)
head(df)
plot(et)
plot(df$et)
source('x.r')
setwd('./feb04')
system('ls')
source('x.r')
head(df)
max(df$et)
tally <- numeric(8521)
tally
for (x in df$et) tally[x] = tally[x] + 1
df[substr(df$user,1,2) == 'cs' | substr(df$user,1,2) == 'ds',]
df2 <- df[substr(df$user,1,2) == 'cs' | substr(df$user,1,2) == 'ds',]
df2$class <- substr(df2$user,1,5)
df2
par(mar=c(2,2,2,2))
par(oma=c(3,3,1,1))
plot(tally[1:300],pch=20,type='s')
par(bg='darkblue')
par(fg='white')
plot(tally[1:300],pch=20,type='s')
print('testing chmod on Rhistory file')
source('fun.r')
df
df2
system("ls")
source('fun.r')
source('run.r')
source('run.r')
source('fun.r')
options(stringsAsFactors=FALSE)
li <- scan('data',what=list('','','','','','','',''))
str(li)
names(li) <- c('user','ip','wday','mon','mday','in','out','rawtime')
str(li)
df <- as.data.frame(li)
df$user
grep('^[dc]s[0-9][0-9][0-9]..$',df$user)
grepl('^[dc]s[0-9][0-9][0-9]..$',df$user)
grep('^[dc]s[0-9][0-9][0-9]..$',df$user)
u <- substr(df$user[grep('^[dc]s[0-9][0-9][0-9]..$',df$user)],1,5)
u
typeof(u)
str(u)
par(bg='azure2')
par(mar=c(3, 1, 1, 1))
par(oma=c(3,3,3,3))
t <- sort(table(u),descreasing=TRUE)
str(t)
t <- sort(table(u),decreasing=TRUE)
str(t)
barplot(t,xaxt='n')
b <- barplot(t,xaxt='n')
b
names(t)
text(x=b,y=-30,names(t),xpd=TRUE,srt=90)
title('2019 CS login count by course',ylab='logins')
par(mar=c(3, 3, 1, 1))
b <- barplot(t,xaxt='n')
text(x=b,y=-30,names(t),xpd=TRUE,srt=90)
title('2019 CS login count by course',ylab='logins')
mtext(side=2,text='logins',line=3)
readLines('..terrehaute.clean',1)
readLines('../terrehaute.clean',1)
s <- readLines('../terrehaute.clean',1)
colnames <- strsplit(s,':')
colnames
li <- scan("../terrehaute.clean", sep=':', what=list('',0,0), skip=1)
str(li)
names(li) <- colnames
str(li)
names(li) <- colnames[[1]]
str(li)
colname[[1]]
colnames[[1]]
df <- as.data.frame(li)
str(df)
options(stringsAsFactors=F)
df <- as.data.frame(li)
str(df)
df$mon <- as.integer(substr(df$date,6,7))
df$mon
head(df)
aggregate(df$hi, list(df$mon), mean)
ag <- aggregate(df$hi, list(df$mon), mean)
ag
month.abb
month
month.name
month.abb
plot(ag)
plot(ag,xaxt='n')
plot(ag,xaxt='n',type='o')
plot(ag,xaxt='n',type='o',pch=12)
plot(ag,xaxt='n',type='o',pch=20)
x <- rnorm(10)
x
x <- rnorm(10,0,1)
x
x <- rnorm(10,100,10)
x
c(1:20)
c(1:20) + rnorm(20,3,2)
x <- c(1:20) + rnorm(20,3,2)
plot(x)
y <- c(1:20) + rnorm(20,5,3)
x
y
plot(x,y)
lm(y ~ x)
abline(lm(y ~ x))
cor(x,y)
cor(x,y) ** 2
x <- rnorm(100)
y <- rnorm(100)
plot(x,y)
lm(y ~ x)
cor(x,y) ** 2
x <- c(1:25)
y <- 3 * c(1:25) +7
x
y
plot(x,y)
cor(x,y)
y <- - 3 * c(1:25) +7
plot(x,y)
cor(x,y)
x <- rnorm(50,10,5)
y <- rnorm(50,12,9)
x
y
t(x,y)
t.test(x,y)
wilcox.test(x,y)
x
y
t.test(x,y)
wilcox.test(x,y)
tt <- t.test(x,y)
tt
str(tt)
tt$p.value
lm(y ~ x)
m <- lm(y ~ x)
str(m)
m <- plot(lm(y ~ x))
x
y
lm(y ~ x)
abline(lm(y ~ x))
plot9x,y)
plot(x,y)
abline(lm(y ~ x))
df <- read.csv('indy.csv')
str(cf)
str(df)
substr(df$date,1,4)
as.integer(substr(df$date,1,4))
df$year <- as.integer(substr(df$date,1,4))
head(df)
df$mon <- as.integer(substr(df$date,6,7))
head(df)
aggregate(df$max,list(df$year),mean)
aggregate(df$tmax,list(df$year),mean)
ag <- aggregate(df$tmax[df$year < 2019],list(df$year[df$year < 2019]),mean)
ag
ag2 <- aggregate(df$tmax,list(df$year[df$year < 2019]),mean)
ag
plot(ag)
par(mar=c(4,4,1,1))
par(oma=c(4,4,1,1))
plot(ag,type='o',pch=20)
ag
str(ag)
names(ag) <- c('year','meantemp')
str(ag)
x <- ag$year
y <- ag$meantemp
plot(x,y,type='o',pch=20,ylab='',xlab='',axes=F)
mod <- lm(y ~ x)
summary(mod)
abline(mod)
?axis
axis(side=1,at=x,labels=x)
plot(x,y,type='o',pch=20,ylab='',xlab='',axes=F)
axis(side=1,at=x,labels=x,las=2)
x
seq(1943,2018,5)
plot(x,y,type='o',pch=20,ylab='',xlab='',axes=F)
axis(side=1,at=seq(1943,2018,5),labels=x,las=2)
axis(side=1,at=seq(1943,2018,5),labels=seq(1943,2018,5),las=2)
grid(v=seq(1943,2018,5))
?grid
grid(NULL,NULL)
grid(seq(1943,2018,5),NULL)
ag2 <- aggregate(df$tmin[df$year < 2019],list(df$year[df$year < 2019]),mean)
ag2
names(ag2) <- c('year','meantemp')
x <- ag2$year
y <- ag2$meantemp
mod2 <- lm(y ~ x)
summary(mod2)
plot(x,y,type='o',pch=20,ylab='',xlab='')
abline(mod2)
df
save(df,file='indydata.rda')
df
?df
load('indydata.rda')
df
head(df)
x <- df$tmax[df$year == 1943]
x
length(x)
y <- df$tmax[df$year == 2018]
length(y)
mean(x)
mean(y)
plot(x)
as.integer(x / 10)
as.integer(x / 5)
table(as.integer(x / 5))
plot(table(as.integer(x / 5)))
?shapiro
??shapiro
shapiro.test(x)
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(rnorm(100))
shapiro.test(x)
shapiro.test(y)
wilcox.test(x,y)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
x <- c(rnorm(25,25,10),rnorm(25,25,10),rnorm(25,75,10),rnorm(25,75,10))
y <- c(rnorm(25,25,10),rnorm(25,75,10),rnorm(25,25,10),rnorm(25,75,10))
plot(x,y,pch=20)
df <- data.frame(x=x,y=y,color=rep(0,100))
head(df)
ctr <- sample(1:100,4)
ctr
cx <- df$x[ctr]
cx
cy <- df$y[ctr]
points(cx,cy,col='red',pch='X')
df
paste('dist',2,sep='-')
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - dy[i])^2)
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
head(df)
df
df$oldcolor <- df$color
df
min(c(4,2,1,6,8))
which.min(c(4,2,1,6,8))
df$color <- apply(df[c(4:7)], 1, which.min)
df[c(4:7)]
head(df,25)
plot(x,y,pch=16,col=df$color)
df[4]
mean(df[4])
df[4]
head(df)
df[,4]
df
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
cx
cy
points(cx,cy,pch='X',col='red')
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
df$oldcolor <- df$color
df$color <- apply(df[c(4:7)], 1, which.min)
for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
plot(x,y,pch=16,col=df$color)
points(cx,cy,pch='X',col=c(1:4))
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }    plot(x,y,pch=16,col=df$color)
for (j in 1:100){
  for (i in 1:4) df[paste('dist',i,sep='')] <- sqrt((df$x - cx[i])^2 + (df$y - cy[i])^2)
  df$oldcolor <- df$color
  df$color <- apply(df[c(4:7)], 1, which.min)
  for (i in 1:4) { cx[i] <- mean(df[df$color == i,1]); cy[i] <- mean(df[df$color == i,2]) }
  plot(df$x,df$y,pch=16,col=df$color)
  points(cx,cy,pch='X',col=c(1:4))
  readline(prompt='? ')
}  
df$color
df$oldcolor
all(df$color == df$oldcolor)
x
y
df
df <- df[,c(1,2)]
df
li <- kmeans(2,df)
li <- kmeans(2,df)
body('kmeans')
source('kmeans.r')
source('kmeans.r')
li <- kmeans(2,df)
li <- mykmeans(2,df)
li
df
li <- mykmeans(3,df)
library('dplyr')
packages.remove('plotly')
remove.packages('plotly')
cd
cd
library(plotly)
setwd('lib/R')
source('km3.r')
source('plotly.r')
library(plotly)
source('km3.r')
plot_ly(d,x = ~x, y = ~y, z = ~z,type='scatter3d',mode='markers',color=d$color,colors=c('black','orange','dodgerblue','green','red'),opacity=1,marker=list(size=2))
source('km3a.r')
source('km3a.r')
p
source('km3a.r')
p
vi km3.r
source('km3a.r')
p
vi km3a.r
q('n')
x <- 3
q('n')
source('km3a.r')
p
df <- read.csv('nonsense.csv',sep=':')
length(df$x)
length(df$x[df$color == 5])
length(df)

length(df$x[df$color == 5 & df$x > 90])
df$x[df$color == 5 & df$x > 90]
df[df$color == 5 & df$x > 90,]
df[df$x > 90,]
df$y[df$color == 3]
mean(df$y[df$color == 3])
1/3 == (1 - 2/3)
abs( 1/3 - (1 - 2/3)) < 0.001
v <- df$name[df$color == 2]
v
length(v)
sort(df$name)[1]
sqrt((df$x - 10)^2 + (df$y - 10)^2)
max(sqrt((df$x - 10)^2 + (df$y - 10)^2) < 10)
max(sqrt((df$x - 10)^2 + (df$y - 10)^2))
s <- max(sqrt((df$x - 10)^2 + (df$y - 10)^2))
df[sqrt((df$x - 10)^2 + (df$y - 10)^2) > s - 0.001,]
df[sqrt((df$x - 10)^2 + (df$y - 10)^2) == s,]
1/13 == (1 - 12/13)
df[sqrt((df$x - 10)^2 + (df$y - 10)^2) > s - 0.1,]
df[sqrt((df$x - 10)^2 + (df$y - 10)^2) > s - 1.0,]
df2 <- df[ abs(df$x - 50) + abs(df$y - 50) <= 25, ]
df2
df2 <- df[ abs(df$x - 50) + abs(df$y - 50) <= 25,c(1,3,4) ]
df2
df[ abs(df$x - 50) + abs(df$y - 50) == 25,]
df$color[df$x > 90] <- 6
df
df$color[sqrt((df$x - 25)^2 + (df$y - 25)^2) < 10] <- 7
df
plot(df$x,df$y,col=df$color,pch=16)
f <- function(x1,y1,x2,y2,p)
{ (abs(x1-x2)^p + abs(y1-y2)^)^(1/p) }
f(1,1,2,2,2)
f <- function(x1,y1,x2,y2,p) { (abs(x1-x2)^p + abs(y1-y2)^p)^(1/p) }
f(1,1,2,2,2)
for (p in 1:20) print(f(5,1,4,4,p))
for (p in 1:20) print(f(5,1,3,4,p))
plot(df$x[df$color == 1],df$y[df$color == 1],col='red',pch=20)
plot(df$x[df$color == 1],df$y[df$color == 1],col='red',pch=20)
points(df$x[df$color == 2],df$y[df$color == 2],col='blue',pch=20)
library('plotly')
q("n")
q("no")
x <- vector()
for (i in 1:4) x <- c(x,rnorm(100, 10*i, 4))
x
plot(x)
y <- vector()
for (i in 1:4) y <- c(y,rnorm(100, 15*i, 5))
x
y
plot(x,y)
df <- data.frame(x=x,y=y)
head(df)
km <- kmeans(df)
?kmeans
km <- kmeans(df,4)
km
km$cluster
df$colors <- km$cluster
plot(x,y,col=df$color,pch=20)
ctr <- km$centers
ctr
points(ctr,col='orange',pch='X')
points(ctr,col='red',pch='X')
m <- matrix(c(3,2,1,4),nrow)
m <- matrix(c(3,2,1,4),nrow=2)
m
v <- c(2,1)
v
m
v
m %*% v
m %*% c(3,3)
xx <- rep(1:5,5)
xx
yy <- sort(xx)
y
y
yy <- sort(xx)
yy
plot(xx,yy,pch=20)
plot.new()
plot.window(xlim=c(-10,20),ylim=c(-10,20))
plot(xx,yy,pch=20)
plot.new()
plot(xx,yy,pch=20)
plot.new()
plot.window(xlim=c(-10,20),ylim=c(-10,20))
points(xx,yy,pch=20)
lines(c(0,0),c(-10,20))
lines(c(-10,20),c(0,0))
xx
yy
c(xx,yy)
matrix(c(xx,yy),nrow=25)
pts <- matrix(c(xx,yy),nrow=25)
pts
m
m
t(m)
pts
t(pts)
m %*% t(pts)
t(m %*% t(pts))
pts
t(m %*% t(pts))
newpts <- t(m %*% t(pts))
points(newpts, col='red', pch=20)
plot.new()
plot.window(xlim=c(-10,30),ylim=c(-10,30))
points(newpts, col='red', pch=20)
points(xx,yy,pch=20)
lines(c(-10,20),c(0,0))
lines(c(0,0),c(-10,20))
m
eigen(m)
points(1,2,pch=16,col='blue')
points(5,10,pch=16,col='blue')
points(-1,1,pch=16,col='green')
points(-2,2,pch=16,col='green')
m %*% c(-1,1)
df
df$[c(1,2)]
df[c(1,2)]
cov(df[c(1,2)])
m2 <- cov(df[c(1,2)])
eigen(m2)
plot(x,y,col=df$color,pch=16)
eg <- eigen(m2)
eg$vectors
eg$vectors[,1]
v <- eg$vectors[,1]
v[2]/v[1]
a <- v[2]/v[1]
lines(c(0,50),c(0,a*50))
ctr
points(ctr,pch='X',col=c('red','red','blue','red'))
points(ctr,pch='X',col=c('red','blue','red','red'))
fft(c(1:4))
fft(rep(1:4),4)
f <- function(){ 3;5;7}
f()
f <- function(){ 3;5;x<-8}
f()
x
x<-9
f()
x
exit
source('eigendemo3d.r')
source('eigendemo3d.r')
p
source('eigendemo3da.r')
p
dput(p,'x')
p <- 4
ls
rm(p)
ls()
p<-dget('x')
p
?source
savehistory(file='x')
ls
rm(x)
ls
ls()
egg
rm(gg)
rm(egg)
source('eigendemo3d.r')
p
source('eigendemo3da.r')
p
df <- read.csv('/u1/junk/cs459/quizdata.csv',sep=':')
mean(df$wgt1)
mean(df$wgt1[df$type == 'Q'])
sort(table(df$id))
df2 <- df[df$type == 'K',]
df2
m <- mean(df$wgt2)/2
df$wgt2[df$wgt2 >= m]
length(df$wgt2[df$wgt2 >= m])
m <- max(df$wgt2)/2
length(df$wgt2[df$wgt2 >= m])
rowSums(df2[,2:3])
df$xxx <- rowSums(df[,2:3])
head(df)
mode()
sort(data$id)
   df1 <- subset(data, id=='zzz')
   length(df1$id)
sort(df$id)
d<- subset(df,type=='K')
d
df$unit=1
aggregate(df$unit, list(df$id), sum)
max(aggregate(df$unit, list(df$id), sum))
sort(table(df$id))
df <- read.csv("../quizdata.csv",sep=":")
mean(df$wgt1)
df$wgt1
head(df)
mean(df$wgt1)
mean(df$wgt1[df$type == 'Q'])
df$type[df$type == 'C' & df$count == 4]
df$type[df$type == 'C' & df$count1 == 4]
df$type[df$type == 'C' & df$count1 == 4] <- 'B'
head(df,25)
df$total <- df$count1 df$count2
df$total <- df$count1 + df$count2
ag <- aggregate(df$id,list(df$id),length)
ag
head(ag)
names(ag) <- c('id','count')
head(ag)
ag$id[ag$count == max(ag$count),]
ag$id[ag$count == max(ag$count)]
ag[ag$count == max(ag$count),]
?order
ag[order(af$count),]
ag$id[order(af$count)]
ag[order(ag$count),]
sort(table(df$id))
plot(df$wgt1,df$wgt2,col=df$count2)
pdf('problem8.pdf')
plot(df$wgt1,df$wgt2,col=df$count2,pch=20)
dev.off()
pdf('problem8.pdf')
df2 <- df[df$type == 'K',]
df2
plot(df2$wgt1,df2$wgt2,col=df2$count2,pch=20)
dev.off()
ag2 <- aggregate(df$type,list(df$type),length)
ag2
names(ag2) <- c("type","count")
head(ag2)
pdf("problem9.pdf")
barplot(ag2$count,names.var=ag$type)
?barplot
dev.off()
pdf("problem9.pdf")
barplot(ag2$count,names.arg=ag$type)
dev.off()
?barplot
pdf("problem9.pdf")
barplot(ag2$count,names.arg=ag2$type)
dev.off()
df
m <- min(df$wgt2)
m
m <- max(df$wgt2)
m
m <- max(df$wgt2)/2
n
m
df$id[df$wgt2 >= m]
length(df$id[df$wgt2 >= m])
q('no')
f <- f(x)
f <- function(x)
{
  x <- x + 1
  print(x)
}
x <- 4
x
f(x)
x
x <- 0
repeat {
   x <- x + 1
   print(x)
   if(x > 10) break;
}
for (i in 1:10) print(i)
for (i in 10){
   print(i) ; print(i**2)
   print(i**3)
}
v <- c(1:10)
ifelse(v % 2 == 0, "even", "odd")
ifelse(v %% 2 == 0, "even", "odd")
v <- "beta"
switch(v, "alpha": 3, "beta" : 5, "gamma": 7, 9)
switch(v, "alpha": 3, "beta" : 5, "gamma": 7)
?switch
switch(v, "alpha"=  3, "beta" = 5, "gamma"= 7)
switch(v, "alpha"=  3, "beta" = 5, "gamma"= 7, 9)
v <- "delta"
switch(v, "alpha"=  3, "beta" = 5, "gamma"= 7, 9)
v <- c("alpha","beta","epsilon","x")
v
ifelse(length(v) > 5, "long", "short")
ifelse(apply(v,1,length) > 5, "long", "short")
apply(v,1,length)
apply(list(v),1,length)
nchar(v)
ifelse(nchar(v) > 5, "long", "short")
letters
sample(letters,7)
sample(letters,7)
paste(sample(letters,7),collapse)
paste(sample(letters,7),collapse='')
replicate( 100, paste(sample(letters,7),collapse=''))
replicate( 100, paste(sample(letters,7),collapse=''), simplify=vector)
df <- data.frame(stu=replicate( 100, paste(sample(letters,7),collapse=''), simplify=vector))
df
rbinom(100, 100, 0.7)
rbinom(2, 100, 0.7)
rbinom(100, 100, 0.5)
for (i in 1:8) df[paste("quiz",i,sep='')] <- rbinom(2, 100, 0.8 - i/20)
df
head(d)
head(df)
for (i in 1:8) df[paste("quiz",i,sep='')] <- rbinom(100, 100, 0.8 - i/20)
df
?rowSum
?rowSums
rowSums(df[c(2:9)])
df$tot <- rowSums(df[c(2:9)])
head(df)
df[c(2:9)]
rowSums(df[c(2:9)])
dc
head(df)
quantile(df$tot,probs=c(0.1, 0.3, 0.7, 0.9))
quant <- quantile(df$tot,probs=c(0.1, 0.3, 0.7, 0.9))
grade <- function(x)
{
   if(x >= quant[4]) return("A")
   else if(x >= quant[3]) return("B")
   else if(x >= quant[2]) return("C")
   else if(x >= quant[1]) return("D")
   return("F")
}
grade(450)
apply(df$tot, 1, grade)
apply(df[,10], 1, grade)
apply(df[10], 1, grade)
df[10]
df$g1 <- apply(df[10], 1, grade)
head(df)
df$tot
min(df[c(2:9)])
apply(df[c(2:9)], 1, min)
head(df)
apply(df[c(2:9)], 1, min)
df$tot
df$tot - apply(df[c(2:9)], 1, min)
df$tot2 <- df$tot - apply(df[c(2:9)], 1, min)
quant <- quantile(df$tot2,probs=c(0.1, 0.3, 0.7, 0.9))
quant
df$g1 <- apply(df["tot2"], 1, grade)
head(df)
df <- read.csv('shortlist.csv',sep=',')
str(df)
df$label
df[1,c(2:785)]
typeof(df[1,c(2:785)])
as.numeric(df[1,c(2:785)])
typeof(as.numeric(df[1,c(2:785)]))
m <- matrix(v,nrow=28,byrow=F)
v <- as.numeric(df[1,c(2:785)])
m <- matrix(v,nrow=28,byrow=F)
m

max(m)
image(x=1:28,y=1:28,z=m)
df$label
v <- as.numeric(df[7,c(2:785)])
m <- matrix(v,nrow=28,byrow=F)
image(x=1:28,y=1:28,z=m)
image(x=1:28,y=1:28,z=m,col=gray(c(0:255)/255))
m <- matrix(v,nrow=28,byrow=T)
m <-  matrix(as.numeric(df[7,c(2:785)]), nrow=28)
image(x=1:28,y=1:28,z=m,col=gray(c(0:255)/255))
image(x=1:28,y=1:28,z=m[28:1,],col=gray(c(0:255)/255))
image(x=1:28,y=1:28,z=m[,28:1],col=gray(c(0:255)/255))
par(mar=c(0,0,0,0))
par(mfrow=c(6,4))
for (i in 1:24){
   m <-  matrix(as.numeric(df[i,c(2:785)]), nrow=28)
   image(x=1:28,y=1:28,z=m[,28:1],col=gray(c(0:255)/255))
}
nrow(df[df$label==8,])
nrow(df)
colSum(df[df$label==8,])
colSum(df[df$label==8,c(2:785)])
colSums(df[df$label==8,c(2:785)])
colSums(df[df$label==8,c(2:785)])/93
v <- colSums(df[df$label==8,c(2:785)])/93
m <- matrix(v,nrow=28)
m
image(x=1:28,y=1:28,m[,28:1],col=gray(c(0:255)/255))
v <- colSums(df[df$label==1,c(2:785)])/93
length(v)
nrow(df[df$label==1,c(2:785)])
v <- colSums(df[df$label==1,c(2:785)])/96
m <- matrix(v,nrow=28)
image(x=1:28,y=1:28,m[,28:1],col=gray(c(0:255)/255))
f <- function(n)   # label                                                                
{
   v <- colSums(df[df$label == n, c(2:785)])
   m <- matrix(v,nrow=28)
   m <- m[,28:1]
   return(m)
}
f(1)
mat <- f(1)
image(x=1:28,y=1:28,m,col=gray(c(0:255)/255))
image(x=1:28,y=1:28,mat,col=gray(c(0:255)/255))
image(x=1:28,y=1:28,f(2),col=gray(c(0:255)/255))
image(x=1:28,y=1:28,f(3),col=gray(c(0:255)/255))
image(x=1:28,y=1:28,f(4),col=gray(c(0:255)/255))
image(x=1:28,y=1:28,f(5),col=gray(c(0:255)/255))
df <- read.csv('train.csv',sep=',')
system.time(f(9))
m <- f(9)
max(m)
m <- m/max(m)
m
image(x=1:28,y=1:28,m,col=gray(c(0:1)))
image(x=1:28,y=1:28,m,col=gray(c(0:2)))
m <- m/(max(m)/255)
m
df$image
df$label
df$label[c(1:10)]
v1 <- as.numeric(df[4,c(2:785)])
v1
v2 <- as.numeric(df[8,c(2:785)])
v3 <- as.numeric(df[10,c(2:785)])
v1 - v2
abs(v1 - v2)
sum(abs(v1 - v2))
max(abs(v1 - v2))
sqrt((v1 - v2)**2)
sqrt(sum((v1 - v2)**2))
sqrt(sum((v3 - v2)**2))
sqrt(sum((v1 - v2)**2))
max(abs(v1 - v2))
sum(abs(v1 - v2))
sum(abs(v3 - v2))
sum(abs(v3 - v1))
load('loadme.rda')
df
ls()
x <- 23
q()
df
length(df)
df[1]
head(df[2])
head(df[333])
head(df[333],33)
colSums(df[c(2:785)])
v <- as.numeric(colSums(df[c(2:785)]))
v
plot(v)
dev.off()
plot(v,pch=20,type='o')
dev.off()
v
u <- vector() ; for (i in 1:757) u[i] <- sum(v[i:(i+27)])
u
plot(u,pch=20,type='o')
dev.off()
load('loadme.rda')
ls()
head(df,25)
options(width=130)
head(df,25)
mean(df$quiz3)
df$stu[df$quiz2 > df$quiz1]
length(df$stu[df$quiz2 > df$quiz1])
df[,c(2:10)]
rowSums(df[,c(2:10)])
df$total <- rowSums(df[,c(2:10)])
head(df,25)
quant <- quantile(df$total,c(0.50,0.70,0.85,0.95))
quant
grade <- function(x)
{
   if(x >= quant[4]) return("A");
   if(x >= quant[3]) return("B");
   if(x >= quant[2]) return("C");
   if(x >= quant[1]) return("D");
   return("F")
}
sapply(df$total,grade)
df$grade <- sapply(df$total,grade)
head(df)
quant
?cut
length(df$stu[df$grade == 'F'])
nrow(df[df$grade == 'F',])
hi <- max(df$quiz4)
hi
df$stu[df$quiz4 == hi]
hi <- max(df$quiz4[df$grade == 'F'])
hi
df$stu[df$quiz4 == hi & df$grade == 'F']
n<- nrow(df)
n
colSums(df[,c(2:10)])
colSums(df[,c(2:10)])/n
max(colSums(df[,c(2:10)])/n)
which.max(colSums(df[,c(2:10)])/n)
max(colMeans(df[,c(2:10)]))
df[substr(df$stu,1,5) == 'tenet,]
df[substr(df$stu,1,5) == 'tenet',]
df$quiz5[substr(df$stu,1,5) == 'tenet',]
df$quiz5[substr(df$stu,1,5) == 'tenet']
df$quiz5[substr(df$stu,1,5) == 'tenet'] <- 0
df$quiz5[substr(df$stu,1,5) == 'tenet',]
df$quiz5[substr(df$stu,1,5) == 'tenet',]
df[substr(df$stu,1,5) == 'tenet',]
df[substr(df$stu,1,5) == 'cogin',]
df$quiz5[substr(df$stu,1,5) == 'cogin'] <- 0
df[substr(df$stu,1,5) == 'cogin',]
df$grade
df$newgrade <- df$grade
unclass(factor(df$class))
unclass(factor(df$class,c("Freshman","Sophomore","Junior","Senior")))
df$classno <- unclass(factor(df$class,c("Freshman","Sophomore","Junior","Senior")))
v <- c(1:4)
names(v) <- c("Freshman","Sophomore","Junior","Senior")
v
v[df$class]
df$classno <- v[df$class]
head(df)
v <- c(0:4)
names(v) <- c("F","D","C","B","A")
v[df$grade]
v[df$grade[df$classno == 1]]
mean(v[df$grade[df$classno == 1]])
mean(v[df$grade[df$classno == 2]])
for (i in 1:4) print(mean(v[df$grade[df$classno == i]]))
head(df[order(df$total),],25)
head(df[order(df$total,decreasing=T),],25)
df$total[df$classno == 1] * 1.1
floor(df$total[df$classno == 1] * 1.1)
df$total[df$classno == 1] <- floor(df$total[df$classno == 1] * 1.1)
sapply(df$total,grade)
df$newgrade <- sapply(df$total,grade)
head(df[order(df$total,decreasing=T),],25)
df[,c(2:10)]
as.matrix(df[,c(2:10)])
apply( as.matrix(df[,c(2:10)]), 1, sort)
t(apply( as.matrix(df[,c(2:10)]), 1, sort))
head(t(apply( as.matrix(df[,c(2:10)]), 1, sort)))
head(df)
t(apply( as.matrix(df[,c(2:10)]), 1, sort))
t(apply( as.matrix(df[,c(2:10)]), 1, sort))[4:9]
m <- t(apply( as.matrix(df[,c(2:10)]), 1, sort))
t(apply( as.matrix(df[,c(2:10)]), 1, sort))[,4:9]
rowsum(t(apply( as.matrix(df[,c(2:10)]), 1, sort))[,4:9])
rowSums(t(apply( as.matrix(df[,c(2:10)]), 1, sort))[,4:9])
df$best6 <- rowSums(t(apply( as.matrix(df[,c(2:10)]), 1, sort))[,4:9])
head(df)
df$best6 <- floor(df$best6/6)
head(df)
floor(max(df$best6 - 50, 0) / 10)
max(df$best6,0)
floor((df$best6 - 50) / 10)
max(floor((df$best6 - 50) / 10),0) 
floor((df$best6 - 50) / 10)
v
v?pmax
?pmax
pmax(floor((df$best6 - 50) / 10),0) 
v[pmax(floor((df$best6 - 50) / 10),0) ]

v[floor(pmax((df$best6 - 50) / 10),0) ]
v[floor(pmax((df$best6 - 50) / 10,0)) ]
length(v[floor(pmax((df$best6 - 50)
length(df$best)
length(df$best6)
?pmax
v[floor(pmax((df$best6 - 50) / 10,0)) ]
length(v[floor(pmax((df$best6 - 50) / 10,0)) ])
df$best[df$best6 - 50 >= 0] <- v[floor(pmax((df$best6 - 50) / 10,0)) ]
length(df$best6[df$best6 - 50 >= 0])
df$tmp <- floor((df$best6 - 50) / 10)
df[df$tmp < 0, ]
q()
x <- 23
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
x <- 23
q()
library('shiny')
exit
q()
